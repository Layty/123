using System;

namespace ClassLibraryDLMS.DLMS.HDLC
{
 
    public static class DataCheck
    {
    
        private static uint GetCRC32(byte[] bytes)
        {
            uint iCount = (uint) bytes.Length;
            uint crc = uint.MaxValue;
            foreach (byte b in bytes)
            {
                crc = ((crc >> 8 & 16777215u) ^ Crc32Table[(int) ((crc ^ b) & 255u)]);
            }

            return crc ^ uint.MaxValue;
        }

     
        public static byte[] GetCrc16(byte[] data)
        {
            byte[] returnVal = new byte[2];
            byte CRC16Lo = byte.MaxValue;
            byte CRC16Hi = byte.MaxValue;
            byte CL = 1;
            byte CH = 160;
            for (int i = 0; i < data.Length; i++)
            {
                CRC16Lo ^= data[i];
                for (int Flag = 0; Flag <= 7; Flag++)
                {
                    byte SaveHi = CRC16Hi;
                    byte SaveLo = CRC16Lo;
                    CRC16Hi = (byte) (CRC16Hi >> 1);
                    CRC16Lo = (byte) (CRC16Lo >> 1);
                    bool flag = (SaveHi & 1) == 1;
                    if (flag)
                    {
                        CRC16Lo |= 128;
                    }

                    bool flag2 = (SaveLo & 1) == 1;
                    if (flag2)
                    {
                        CRC16Hi ^= CH;
                        CRC16Lo ^= CL;
                    }
                }
            }

            returnVal[0] = CRC16Hi;
            returnVal[1] = CRC16Lo;
            return returnVal;
        }

     
        public static byte GetSum(byte[] data)
        {
            byte rtnbyte = 0;
            foreach (byte item in data)
            {
                rtnbyte += item;
            }

            return rtnbyte;
        }


        private static byte CRC(byte[] buffer)
        {
            return CRC(buffer, 0, buffer.Length);
        }

 
        private static byte CRC(byte[] buffer, int off, int len)
        {
            byte crc = 0;
            bool flag = buffer == null;
            if (flag)
            {
                throw new ArgumentNullException("buffer");
            }

            bool flag2 = off < 0 || len < 0 || off + len > buffer.Length;
            if (flag2)
            {
                throw new ArgumentOutOfRangeException();
            }

            for (int i = off; i < len; i++)
            {
                crc = CRC8Table[crc ^ buffer[i]];
            }

            return crc;
        }

   
        private static byte CRC8(byte[] buffer)
        {
            byte crc = 0;
            for (int i = 0; i < buffer.Length; i++)
            {
                crc ^= buffer[i];
                for (int j = 0; j < 8; j++)
                {
                    bool flag = (crc & 1) > 0;
                    if (flag)
                    {
                        crc = (byte) (crc >> 1);
                        crc ^= 140;
                    }
                    else
                    {
                        crc = (byte) (crc >> 1);
                    }
                }
            }

            return crc;
        }

  
        public static byte[] CRC16_CCITT(byte[] data, int dataLen)
        {
            int crc = 65535;
            int i = 0;
            while (dataLen-- > 0)
            {
                crc = (crc >> 8 ^ Crc16Table[(crc ^ data[i]) & 255]);
                i++;
            }

            crc ^= 65535;
            return BitConverter.GetBytes((ushort) crc);
        }

  
        private static readonly uint[] Crc32Table = {
            0u,
            1996959894u,
            3993919788u,
            2567524794u,
            124634137u,
            1886057615u,
            3915621685u,
            2657392035u,
            249268274u,
            2044508324u,
            3772115230u,
            2547177864u,
            162941995u,
            2125561021u,
            3887607047u,
            2428444049u,
            498536548u,
            1789927666u,
            4089016648u,
            2227061214u,
            450548861u,
            1843258603u,
            4107580753u,
            2211677639u,
            325883990u,
            1684777152u,
            4251122042u,
            2321926636u,
            335633487u,
            1661365465u,
            4195302755u,
            2366115317u,
            997073096u,
            1281953886u,
            3579855332u,
            2724688242u,
            1006888145u,
            1258607687u,
            3524101629u,
            2768942443u,
            901097722u,
            1119000684u,
            3686517206u,
            2898065728u,
            853044451u,
            1172266101u,
            3705015759u,
            2882616665u,
            651767980u,
            1373503546u,
            3369554304u,
            3218104598u,
            565507253u,
            1454621731u,
            3485111705u,
            3099436303u,
            671266974u,
            1594198024u,
            3322730930u,
            2970347812u,
            795835527u,
            1483230225u,
            3244367275u,
            3060149565u,
            1994146192u,
            31158534u,
            2563907772u,
            4023717930u,
            1907459465u,
            112637215u,
            2680153253u,
            3904427059u,
            2013776290u,
            251722036u,
            2517215374u,
            3775830040u,
            2137656763u,
            141376813u,
            2439277719u,
            3865271297u,
            1802195444u,
            476864866u,
            2238001368u,
            4066508878u,
            1812370925u,
            453092731u,
            2181625025u,
            4111451223u,
            1706088902u,
            314042704u,
            2344532202u,
            4240017532u,
            1658658271u,
            366619977u,
            2362670323u,
            4224994405u,
            1303535960u,
            984961486u,
            2747007092u,
            3569037538u,
            1256170817u,
            1037604311u,
            2765210733u,
            3554079995u,
            1131014506u,
            879679996u,
            2909243462u,
            3663771856u,
            1141124467u,
            855842277u,
            2852801631u,
            3708648649u,
            1342533948u,
            654459306u,
            3188396048u,
            3373015174u,
            1466479909u,
            544179635u,
            3110523913u,
            3462522015u,
            1591671054u,
            702138776u,
            2966460450u,
            3352799412u,
            1504918807u,
            783551873u,
            3082640443u,
            3233442989u,
            3988292384u,
            2596254646u,
            62317068u,
            1957810842u,
            3939845945u,
            2647816111u,
            81470997u,
            1943803523u,
            3814918930u,
            2489596804u,
            225274430u,
            2053790376u,
            3826175755u,
            2466906013u,
            167816743u,
            2097651377u,
            4027552580u,
            2265490386u,
            503444072u,
            1762050814u,
            4150417245u,
            2154129355u,
            426522225u,
            1852507879u,
            4275313526u,
            2312317920u,
            282753626u,
            1742555852u,
            4189708143u,
            2394877945u,
            397917763u,
            1622183637u,
            3604390888u,
            2714866558u,
            953729732u,
            1340076626u,
            3518719985u,
            2797360999u,
            1068828381u,
            1219638859u,
            3624741850u,
            2936675148u,
            906185462u,
            1090812512u,
            3747672003u,
            2825379669u,
            829329135u,
            1181335161u,
            3412177804u,
            3160834842u,
            628085408u,
            1382605366u,
            3423369109u,
            3138078467u,
            570562233u,
            1426400815u,
            3317316542u,
            2998733608u,
            733239954u,
            1555261956u,
            3268935591u,
            3050360625u,
            752459403u,
            1541320221u,
            2607071920u,
            3965973030u,
            1969922972u,
            40735498u,
            2617837225u,
            3943577151u,
            1913087877u,
            83908371u,
            2512341634u,
            3803740692u,
            2075208622u,
            213261112u,
            2463272603u,
            3855990285u,
            2094854071u,
            198958881u,
            2262029012u,
            4057260610u,
            1759359992u,
            534414190u,
            2176718541u,
            4139329115u,
            1873836001u,
            414664567u,
            2282248934u,
            4279200368u,
            1711684554u,
            285281116u,
            2405801727u,
            4167216745u,
            1634467795u,
            376229701u,
            2685067896u,
            3608007406u,
            1308918612u,
            956543938u,
            2808555105u,
            3495958263u,
            1231636301u,
            1047427035u,
            2932959818u,
            3654703836u,
            1088359270u,
            936918000u,
            2847714899u,
            3736837829u,
            1202900863u,
            817233897u,
            3183342108u,
            3401237130u,
            1404277552u,
            615818150u,
            3134207493u,
            3453421203u,
            1423857449u,
            601450431u,
            3009837614u,
            3294710456u,
            1567103746u,
            711928724u,
            3020668471u,
            3272380065u,
            1510334235u,
            755167117u
        };

        // Token: 0x04000002 RID: 2
        private static readonly uint[] crcTable = {
            0u,
            79764919u,
            159529838u,
            222504665u,
            319059676u,
            398814059u,
            445009330u,
            507990021u,
            638119352u,
            583659535u,
            797628118u,
            726387553u,
            890018660u,
            835552979u,
            1015980042u,
            944750013u,
            1276238704u,
            1221641927u,
            1167319070u,
            1095957929u,
            1595256236u,
            1540665371u,
            1452775106u,
            1381403509u,
            1780037320u,
            1859660671u,
            1671105958u,
            1733955601u,
            2031960084u,
            2111593891u,
            1889500026u,
            1952343757u,
            2552477408u,
            2632100695u,
            2443283854u,
            2506133561u,
            2334638140u,
            2414271883u,
            2191915858u,
            2254759653u,
            3190512472u,
            3135915759u,
            3081330742u,
            3009969537u,
            2905550212u,
            2850959411u,
            2762807018u,
            2691435357u,
            3560074640u,
            3505614887u,
            3719321342u,
            3648080713u,
            3342211916u,
            3287746299u,
            3467911202u,
            3396681109u,
            4063920168u,
            4143685023u,
            4223187782u,
            4286162673u,
            3779000052u,
            3858754371u,
            3904687514u,
            3967668269u,
            881225847u,
            809987520u,
            1023691545u,
            969234094u,
            662832811u,
            591600412u,
            771767749u,
            717299826u,
            311336399u,
            374308984u,
            453813921u,
            533576470u,
            25881363u,
            88864420u,
            134795389u,
            214552010u,
            2023205639u,
            2086057648u,
            1897238633u,
            1976864222u,
            1804852699u,
            1867694188u,
            1645340341u,
            1724971778u,
            1587496639u,
            1516133128u,
            1461550545u,
            1406951526u,
            1302016099u,
            1230646740u,
            1142491917u,
            1087903418u,
            2896545431u,
            2825181984u,
            2770861561u,
            2716262478u,
            3215044683u,
            3143675388u,
            3055782693u,
            3001194130u,
            2326604591u,
            2389456536u,
            2200899649u,
            2280525302u,
            2578013683u,
            2640855108u,
            2418763421u,
            2498394922u,
            3769900519u,
            3832873040u,
            3912640137u,
            3992402750u,
            4088425275u,
            4151408268u,
            4197601365u,
            4277358050u,
            3334271071u,
            3263032808u,
            3476998961u,
            3422541446u,
            3585640067u,
            3514407732u,
            3694837229u,
            3640369242u,
            1762451694u,
            1842216281u,
            1619975040u,
            1682949687u,
            2047383090u,
            2127137669u,
            1938468188u,
            2001449195u,
            1325665622u,
            1271206113u,
            1183200824u,
            1111960463u,
            1543535498u,
            1489069629u,
            1434599652u,
            1363369299u,
            622672798u,
            568075817u,
            748617968u,
            677256519u,
            907627842u,
            853037301u,
            1067152940u,
            995781531u,
            51762726u,
            131386257u,
            177728840u,
            240578815u,
            269590778u,
            349224269u,
            429104020u,
            491947555u,
            4046411278u,
            4126034873u,
            4172115296u,
            4234965207u,
            3794477266u,
            3874110821u,
            3953728444u,
            4016571915u,
            3609705398u,
            3555108353u,
            3735388376u,
            3664026991u,
            3290680682u,
            3236090077u,
            3449943556u,
            3378572211u,
            3174993278u,
            3120533705u,
            3032266256u,
            2961025959u,
            2923101090u,
            2868635157u,
            2813903052u,
            2742672763u,
            2604032198u,
            2683796849u,
            2461293480u,
            2524268063u,
            2284983834u,
            2364738477u,
            2175806836u,
            2238787779u,
            1569362073u,
            1498123566u,
            1409854455u,
            1355396672u,
            1317987909u,
            1246755826u,
            1192025387u,
            1137557660u,
            2072149281u,
            2135122070u,
            1912620623u,
            1992383480u,
            1753615357u,
            1816598090u,
            1627664531u,
            1707420964u,
            295390185u,
            358241886u,
            404320391u,
            483945776u,
            43990325u,
            106832002u,
            186451547u,
            266083308u,
            932423249u,
            861060070u,
            1041341759u,
            986742920u,
            613929101u,
            542559546u,
            756411363u,
            701822548u,
            3316196985u,
            3244833742u,
            3425377559u,
            3370778784u,
            3601682597u,
            3530312978u,
            3744426955u,
            3689838204u,
            3819031489u,
            3881883254u,
            3928223919u,
            4007849240u,
            4037393693u,
            4100235434u,
            4180117107u,
            4259748804u,
            2310601993u,
            2373574846u,
            2151335527u,
            2231098320u,
            2596047829u,
            2659030626u,
            2470359227u,
            2550115596u,
            2947551409u,
            2876312838u,
            2788305887u,
            2733848168u,
            3165939309u,
            3094707162u,
            3040238851u,
            2985771188u
        };

        // Token: 0x04000003 RID: 3
        private static readonly byte[] CRC8Table = {
            0,
            94,
            188,
            226,
            97,
            63,
            221,
            131,
            194,
            156,
            126,
            32,
            163,
            253,
            31,
            65,
            157,
            195,
            33,
            127,
            252,
            162,
            64,
            30,
            95,
            1,
            227,
            189,
            62,
            96,
            130,
            220,
            35,
            125,
            159,
            193,
            66,
            28,
            254,
            160,
            225,
            191,
            93,
            3,
            128,
            222,
            60,
            98,
            190,
            224,
            2,
            92,
            223,
            129,
            99,
            61,
            124,
            34,
            192,
            158,
            29,
            67,
            161,
            byte.MaxValue,
            70,
            24,
            250,
            164,
            39,
            121,
            155,
            197,
            132,
            218,
            56,
            102,
            229,
            187,
            89,
            7,
            219,
            133,
            103,
            57,
            186,
            228,
            6,
            88,
            20,
            71,
            165,
            251,
            120,
            38,
            196,
            154,
            101,
            59,
            217,
            135,
            4,
            90,
            184,
            230,
            167,
            249,
            27,
            69,
            198,
            152,
            122,
            36,
            248,
            166,
            68,
            26,
            153,
            199,
            37,
            123,
            58,
            100,
            134,
            216,
            91,
            5,
            231,
            185,
            140,
            210,
            48,
            110,
            237,
            179,
            81,
            15,
            78,
            16,
            242,
            172,
            47,
            113,
            147,
            205,
            17,
            79,
            173,
            243,
            112,
            46,
            204,
            146,
            211,
            141,
            111,
            49,
            178,
            236,
            14,
            80,
            175,
            241,
            19,
            77,
            206,
            144,
            114,
            44,
            109,
            51,
            209,
            143,
            12,
            82,
            176,
            238,
            50,
            108,
            142,
            208,
            83,
            13,
            239,
            177,
            240,
            174,
            76,
            18,
            145,
            207,
            45,
            115,
            202,
            148,
            118,
            40,
            171,
            245,
            23,
            73,
            8,
            86,
            180,
            234,
            105,
            55,
            213,
            139,
            87,
            9,
            235,
            181,
            54,
            104,
            138,
            212,
            149,
            203,
            41,
            119,
            244,
            170,
            72,
            22,
            233,
            183,
            85,
            11,
            136,
            214,
            52,
            106,
            43,
            117,
            151,
            201,
            74,
            20,
            246,
            168,
            116,
            42,
            200,
            150,
            21,
            75,
            169,
            247,
            182,
            232,
            10,
            84,
            215,
            137,
            107,
            53
        };

        // Token: 0x04000004 RID: 4
        public static ushort[] Crc16Table = {
            0,
            4489,
            8978,
            12955,
            17956,
            22445,
            25910,
            29887,
            35912,
            40385,
            44890,
            48851,
            51820,
            56293,
            59774,
            63735,
            4225,
            264,
            13203,
            8730,
            22181,
            18220,
            30135,
            25662,
            40137,
            36160,
            49115,
            44626,
            56045,
            52068,
            63999,
            59510,
            8450,
            12427,
            528,
            5017,
            26406,
            30383,
            17460,
            21949,
            44362,
            48323,
            36440,
            40913,
            60270,
            64231,
            51324,
            55797,
            12675,
            8202,
            4753,
            792,
            30631,
            26158,
            21685,
            17724,
            48587,
            44098,
            40665,
            36688,
            64495,
            60006,
            55549,
            51572,
            16900,
            21389,
            24854,
            28831,
            1056,
            5545,
            10034,
            14011,
            52812,
            57285,
            60766,
            64727,
            34920,
            39393,
            43898,
            47859,
            21125,
            17164,
            29079,
            24606,
            5281,
            1320,
            14259,
            9786,
            57037,
            53060,
            64991,
            60502,
            39145,
            35168,
            48123,
            43634,
            25350,
            29327,
            16404,
            20893,
            9506,
            13483,
            1584,
            6073,
            61262,
            65223,
            52316,
            56789,
            43370,
            47331,
            35448,
            39921,
            29575,
            25102,
            20629,
            16668,
            13731,
            9258,
            5809,
            1848,
            65487,
            60998,
            56541,
            52564,
            47595,
            43106,
            39673,
            35696,
            33800,
            38273,
            42778,
            46739,
            49708,
            54181,
            57662,
            61623,
            2112,
            6601,
            11090,
            15067,
            20068,
            24557,
            28022,
            31999,
            38025,
            34048,
            47003,
            42514,
            53933,
            49956,
            61887,
            57398,
            6337,
            2376,
            15315,
            10842,
            24293,
            20332,
            32247,
            27774,
            42250,
            46211,
            34328,
            38801,
            58158,
            62119,
            49212,
            53685,
            10562,
            14539,
            2640,
            7129,
            28518,
            32495,
            19572,
            24061,
            46475,
            41986,
            38553,
            34576,
            62383,
            57894,
            53437,
            49460,
            14787,
            10314,
            6865,
            2904,
            32743,
            28270,
            23797,
            19836,
            50700,
            55173,
            58654,
            62615,
            32808,
            37281,
            41786,
            45747,
            19012,
            23501,
            26966,
            30943,
            3168,
            7657,
            12146,
            16123,
            54925,
            50948,
            62879,
            58390,
            37033,
            33056,
            46011,
            41522,
            23237,
            19276,
            31191,
            26718,
            7393,
            3432,
            16371,
            11898,
            59150,
            63111,
            50204,
            54677,
            41258,
            45219,
            33336,
            37809,
            27462,
            31439,
            18516,
            23005,
            11618,
            15595,
            3696,
            8185,
            63375,
            58886,
            54429,
            50452,
            45483,
            40994,
            37561,
            33584,
            31687,
            27214,
            22741,
            18780,
            15843,
            11370,
            7921,
            3960
        };
    }
}
